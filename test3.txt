This code modified by me.